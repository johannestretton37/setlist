webpackJsonp([1],{AqYa:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkRGRjMxMkU1RTQyRDExRTc5REMzRjFEMUM4QUM1QzhFIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkRGRjMxMkU2RTQyRDExRTc5REMzRjFEMUM4QUM1QzhFIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6REZGMzEyRTNFNDJEMTFFNzlEQzNGMUQxQzhBQzVDOEUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6REZGMzEyRTRFNDJEMTFFNzlEQzNGMUQxQzhBQzVDOEUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6GXrU1AAAAEElEQVR42mL4//8/A0CAAQAI/AL+26JNFgAAAABJRU5ErkJggg=="},C4mC:function(t,e){},CmRb:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("7+uW"),n=s("Xxa5"),o=s.n(n),r=s("exGp"),a=s.n(r),l=s("Dd8w"),d=s.n(l),g={name:"Song",props:["song","order"],methods:{updateItemPositions:function(){for(var t=document.getElementsByClassName("song-item-container"),e={},s=0;s<t.length;s++){var i=t[s],n=i.id,o=i.dataset.order;if(n){var r=i.getBoundingClientRect();e[i.id]={order:o,top:r.top,bottom:r.bottom,height:r.height}}}this.$store.commit("itemPositions",e)},positionPlaceholder:function(t){var e=document.getElementById("draggedItemPlaceholder");if(e){var s=t.y-.5*e.getBoundingClientRect().height+window.pageYOffset;e.style.transform="translateY("+s+"px)"}},deleteSong:function(t){this.$store.commit("deleteSong",t.target.dataset.id)},selectItem:function(t){this.$store.commit("draggedItem",this.song),this.positionPlaceholder(t),this.updateItemPositions()},moveItem:function(t){this.positionPlaceholder(t);for(var e in this.itemPositions){var s=this.itemPositions[e];if(t.y>s.top&&t.y<s.bottom){var i=t.y<s.top+.5*s.height;this.$store.commit("draggingOverItemId",{id:e,targetSlot:i?parseInt(s.order,10)-1:parseInt(s.order,10),slotPre:i,slotPost:!i});break}}},dropItem:function(t){var e=this;this.$store.commit("draggedItemEnd"),setTimeout(function(){var t=document.getElementsByClassName("wasMoved")[0];t&&t.classList.remove("wasMoved"),e.$store.commit("itemWasMoved")},400)},handleTouchStart:function(t){var e=this;if(1==t.touches.length){this.distance=0,this.startTime=(new Date).getTime(),this.startX=t.touches[0].clientX,this.startY=t.touches[0].clientY;var s=this.pointFromEvent(t);this.longPressTimer=setTimeout(function(){e.selectItem(s)},500)}},handleTouchMove:function(t){if(this.isDragging)t.preventDefault(),this.moveItem(this.pointFromEvent(t));else{var e=this.startX-t.touches[0].clientX,s=this.startY-t.touches[0].clientY;Math.abs(s)>Math.abs(e)&&console.log("scroll"),Math.abs(s)<Math.abs(e)&&e>0&&t.currentTarget.parentNode.classList.add("delete"),Math.abs(s)>50&&this.cancelLongPress()}},handleTouchEnd:function(t){this.cancelLongPress(),this.isDragging&&(t.preventDefault(),this.dropItem(t))},cancelLongPress:function(){this.longPressTimer&&clearTimeout(this.longPressTimer),console.log("clearing longPressTimer")},handleDragStart:function(t){var e=document.getElementById("dragImg");e.style.display="block",e.style.top=window.pageYOffset+"px",t.dataTransfer.setDragImage(e,0,0),t.dataTransfer.dropEffect="move",this.selectItem(this.pointFromEvent(t))},handleDrag:function(t){this.moveItem(this.pointFromEvent(t))},handleDragEnd:function(t){this.dropItem(t)},pointFromEvent:function(t){var e=t.touches?t.touches[0]:t;return{x:e.clientX,y:e.clientY}}},computed:{slotClasses:function(){return{blankSpot:null!=this.draggedItem&&this.song.id===this.draggedItem.id,draggingOver:this.draggingOverThis,targetSlotPre:this.targetSlot===this.order-1,targetSlotPost:this.targetSlot===this.order,draggable:void 0!==this.order,wasMoved:this.wasMoved===this.song.id}},duration:function(){var t=Math.floor(this.song.duration/60),e=this.song.duration%60;return e<10&&(e="0"+e),t+":"+e},draggedItem:function(){return this.$store.state.draggedItem},draggingOverThis:function(){return this.draggingOverItemId===this.song.id},draggingOverItemId:function(){return this.$store.state.draggingOverItemId},targetSlot:function(){return this.$store.state.targetSlot},wasMoved:function(){return this.$store.state.wasMoved},itemPositions:function(){return this.$store.state.itemPositions},isDragging:function(){return this.$store.state.isDragging},isScrolling:function(){return this.$store.state.isScrolling}}},c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("div",{staticClass:"song-item-container",class:this.slotClasses,attrs:{id:this.song.id,"data-order":this.order,draggable:void 0!==this.order},on:{dragstart:this.handleDragStart,drag:this.handleDrag,dragend:this.handleDragEnd,contextmenu:function(t){return t.preventDefault()},touchstart:this.handleTouchStart,touchmove:this.handleTouchMove,touchend:this.handleTouchEnd,touchcancel:this.handleTouchEnd}},[e("div",{directives:[{name:"show",rawName:"v-show",value:1==this.order,expression:"order == 1"}],staticClass:"slot preSlot"}),this._v(" "),e("span",{staticClass:"songInfo order"},[this._v("\n        "+this._s(this.order)+"\n      ")]),this._v(" "),e("span",{staticClass:"songInfo artist left"},[this._v("\n        "+this._s(this.song.artist)+"\n      ")]),this._v(" "),e("span",{staticClass:"songInfo title"},[this._v("\n        "+this._s(this.song.title)+"\n      ")]),this._v(" "),e("span",{staticClass:"songInfo duration"},[this._v("\n        "+this._s(this.duration)+"\n      ")]),this._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:void 0!==this.order,expression:"order !== undefined"}],staticClass:"slot postSlot"})]),this._v(" "),e("div",{staticClass:"delete-button",attrs:{"data-id":this.song.id},on:{click:this.deleteSong}},[this._v("\n    DELETE\n  ")])])},staticRenderFns:[]},h=s("VU/8")(g,c,!1,function(t){s("C4mC")},"data-v-5e5fcf0a",null).exports,u=s("Zrlr"),m=s.n(u),v=s("i81k"),p=s.n(v),f=function t(e,s,i,n){m()(this,t),this.id=p()(),this.title=e,this.artist=s,this.duration=i,this.isEncore=n||!1},S={name:"SongsTotal",props:["songs"],components:{Song:h},computed:{total:function(){var t=0,e=0;return this.songs.forEach(function(s){t++,e+=s.duration}),{title:t+" songs in total",duration:e}}}},I={render:function(){var t=this.$createElement;return(this._self._c||t)("Song",{attrs:{song:this.total}})},staticRenderFns:[]},w={name:"Songs",components:{Song:h,SongsTotal:s("VU/8")(S,I,!1,null,null,null).exports},props:["songs"],computed:{draggedItemPlaceholder:function(){var t=new f(this.$store.state.draggedItem.title,this.$store.state.draggedItem.artist,this.$store.state.draggedItem.duration);return t},isDragging:function(){return this.$store.state.isDragging}}},T={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"songs"},[e("transition-group",{staticClass:"song-items-container",attrs:{tag:"ul",name:"rearrange"}},[this._l(this.songs,function(t,s){return e("Song",{key:t.id,attrs:{order:s+1,song:t}})}),this._v(" "),e("hr",{key:"divider"}),this._v(" "),this.songs.length>0?e("SongsTotal",{key:"total",attrs:{songs:this.songs}}):this._e()],2),this._v(" "),this.isDragging?e("div",{attrs:{id:"draggedItemPlaceholder"}},[e("Song",{attrs:{song:this.draggedItemPlaceholder}})],1):this._e()],1)},staticRenderFns:[]},E=s("VU/8")(w,T,!1,function(t){s("q5PM")},"data-v-c48b242c",null).exports,L=s("NYxO"),A=function t(e){m()(this,t),this.songs=[],this.name=e||"Untitled SetList"},b={name:"SetList",components:{Songs:E},computed:d()({},Object(L.b)(["setList"])),data:function(){return{idleTimer:null,newSetListTitle:"",newSongTitle:"",newSongArtist:"",newSongDuration:""}},methods:{addSetList:function(){var t=new A(this.newSetListTitle);this.$store.commit("addSetList",t),this.resetForm()},handleInput:function(t){this.startIdleTimer(t.target);var e=t.target.value;switch(t.target.dataset.model){case"songTitle":e.length>2&&(console.log("Searching for",e),this.stopIdleTimer())}},handleBlur:function(t){this.stopIdleTimer()},startIdleTimer:function(t){var e=this;this.stopIdleTimer(),this.idleTimer=setTimeout(function(){e.idleTimer&&(e.stopIdleTimer(),console.log("User idle, performing search for:",t.value))},2e3)},stopIdleTimer:function(){clearTimeout(this.idleTimer)},addSong:function(){var t=new f(this.newSongTitle,this.newSongArtist,this.toSeconds(this.newSongDuration));this.$store.commit("addSong",t),this.resetForm()},resetForm:function(){this.newSetListTitle="",this.newSongTitle="",this.newSongArtist="",this.newSongDuration="",document.activeElement.blur()},onEnter:function(t){document.querySelector(".new-song-form").style.height=t.getBoundingClientRect().height+"px"},afterEnter:function(t){t.querySelector("input[autofocus]").focus()},toSeconds:function(t){if(""===t)return 0;var e=t.split(/[:,.]/gi);if(e.length<=1)return parseInt(t,10);return 60*parseInt(e[0].trim(),10)+parseInt(e[1].trim(),10)},notEmpty:function(t){return{empty:""===t}}}},_={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("h2",[t._v(t._s(t.setList?t.setList.name:this.newSetListTitle||"Welcome"))]),t._v(" "),s("div",{staticClass:"new-song-form"},[s("transition",{attrs:{name:"fade-right-to-left"},on:{enter:t.onEnter,"after-enter":t.afterEnter}},[null===t.setList?s("form",{key:"addSetList",staticClass:"add-setlist-form",on:{submit:function(e){e.preventDefault(),t.addSetList(e)}}},[s("h3",{staticStyle:{"grid-area":"header"}},[t._v("New SetList")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newSetListTitle,expression:"newSetListTitle"}],staticClass:"center",staticStyle:{"grid-area":"title"},attrs:{type:"text",autofocus:"",placeholder:"Name"},domProps:{value:t.newSetListTitle},on:{input:function(e){e.target.composing||(t.newSetListTitle=e.target.value)}}}),t._v(" "),s("button",{staticStyle:{"grid-area":"submit"}},[t._v("Create SetList")])]):s("form",{key:"addNewSong",staticClass:"add-song-form",on:{submit:function(e){e.preventDefault(),t.addSong(e)}}},[s("h3",{staticStyle:{"grid-area":"header"}},[t._v("Add new song")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newSongTitle,expression:"newSongTitle"}],staticClass:"center",staticStyle:{"grid-area":"title"},attrs:{type:"text","data-model":"songTitle",autofocus:"",placeholder:"Song Title"},domProps:{value:t.newSongTitle},on:{input:[function(e){e.target.composing||(t.newSongTitle=e.target.value)},t.handleInput]}}),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newSongDuration,expression:"newSongDuration"}],staticClass:"center duration",staticStyle:{"grid-area":"duration"},attrs:{type:"text","data-model":"songDuration",placeholder:"0:00"},domProps:{value:t.newSongDuration},on:{input:[function(e){e.target.composing||(t.newSongDuration=e.target.value)},t.handleInput]}}),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newSongArtist,expression:"newSongArtist"}],staticClass:"center",staticStyle:{"grid-area":"artist"},attrs:{type:"text","data-model":"songArtist",placeholder:"Artist (optional)"},domProps:{value:t.newSongArtist},on:{input:[function(e){e.target.composing||(t.newSongArtist=e.target.value)},t.handleInput]}}),t._v(" "),s("button",{staticStyle:{"grid-area":"submit"}},[t._v("Add song to list")])])])],1),t._v(" "),t.setList?s("Songs",{attrs:{songs:t.setList.songs}}):t._e()],1)},staticRenderFns:[]},y=s("VU/8")(b,_,!1,function(t){s("cabv")},null,null).exports,M={name:"Scroller",data:function(){return{scrollTimer:null}},methods:{handleScroll:function(t){var e=this;null===this.scrollTimer&&(this.$store.commit("scroll",!0),this.scrollTimer=setTimeout(function(){clearTimeout(e.scrollTimer),e.scrollTimer=null,e.$store.commit("scroll",!1)},700))}},created:function(){window.addEventListener("scroll",this.handleScroll)},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)}},D={render:function(){var t=this.$createElement;return(this._self._c||t)("div")},staticRenderFns:[]},R=s("VU/8")(M,D,!1,null,null,null).exports,N=s("AqYa"),C=s.n(N),P=(s("mtWM"),{name:"app",data:function(){return{pixel:C.a,spotifyLoginUrl:"https://accounts.spotify.com/authorize/?client_id="+Object({NODE_ENV:"production"}).SPOTIFY_CLIENT_ID+"&response_type=code&redirect_uri="+Object({NODE_ENV:"production"}).REDIRECT_URI_ENC+"&scope=playlist-modify-public%20user-read-email&state=spotifylogin"}},components:{SetList:y,Songs:E,Scroller:R},created:function(){var t=this;return a()(o.a.mark(function e(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},e,t)}))()}}),x={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("h1",[this._v("SetLister 0.0.3")]),this._v(" "),e("a",{attrs:{href:this.spotifyLoginUrl}},[this._v("Login to Spotify")]),this._v(" "),e("Scroller"),this._v(" "),e("SetList"),this._v(" "),e("img",{attrs:{id:"dragImg",src:this.pixel}})],1)},staticRenderFns:[]},O=s("VU/8")(P,x,!1,function(t){s("CmRb")},null,null).exports;i.a.use(L.a);var U=new L.a.Store({state:{setLists:[],setListIndex:0,draggedItem:null,draggingOverItemId:"",itemPositions:{},targetSlot:-1,wasMoved:"",isDragging:!1,isScrolling:!1},getters:{setList:function(t){return t.setLists[t.setListIndex]||null}},mutations:{loadSetLists:function(t,e){t.setLists=e},scroll:function(t,e){t.isScrolling=e},addSetList:function(t,e){t.setListIndex=t.setLists.length,t.setLists.push(e)},addSong:function(t,e){this.getters.setList.songs.push(e)},deleteSong:function(t,e){this.getters.setList.songs=this.getters.setList.songs.filter(function(t){return t.id!==e})},draggedItem:function(t,e){t.draggedItem=e,t.isDragging=!0,t.wasMoved=""},draggedItemEnd:function(t){if(t.draggedItem&&t.draggedItem.id!==t.draggingOverItemId){var e=G(this.getters.setList,t.draggedItem.id);this.getters.setList.songs.splice(e,1);var s=e>t.targetSlot?0:-1;this.getters.setList.songs.splice(t.targetSlot+s,0,t.draggedItem),t.wasMoved=t.draggedItem.id}t.draggedItem=null,t.isDragging=!1,t.draggingOverItemId="",t.targetSlot=-1},itemWasMoved:function(t){t.wasMoved=""},draggingOverItemId:function(t,e){t.draggingOverItemId=e.id,t.targetSlot=e.targetSlot},itemPositions:function(t,e){t.itemPositions=e}}}),G=function(t,e){return t.songs.findIndex(function(t){return t.id===e})},Y=U;i.a.config.productionTip=!1,new i.a({el:"#app",store:Y,template:"<App/>",components:{App:O}})},cabv:function(t,e){},lVK7:function(t,e,s){s("NHnr")},q5PM:function(t,e){}},["lVK7"]);
//# sourceMappingURL=app.64112b24c11642e1303b.js.map